<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Agenda Kesbangpol 2026 - Kota Semarang</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .gov-header { background: linear-gradient(90deg, #1e3a8a 0%, #1e40af 100%); }
        .nav-active { background-color: #ffffff !important; color: #1e3a8a !important; border-top: 4px solid #1e3a8a; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05); }
        .table-row:nth-child(even) { background-color: #fcfcfc; }
        
        /* Lebar Kolom Konsisten */
        .col-tanggal { width: 15%; }
        .col-kegiatan { width: 70%; }
        .col-status { width: 15%; }

        @media print {
            .no-print { display: none; }
            body { background: white; }
        }
    </style>
</head>
<body>

    <div class="bg-gray-900 text-white text-[10px] py-1 px-6 flex justify-between uppercase tracking-widest no-print">
        <span>Portal Resmi Pemerintah Kota Semarang</span>
        <span id="current-date"></span>
    </div>

    <header class="gov-header text-white shadow-lg no-print">
        <div class="max-w-7xl mx-auto px-6 py-8 flex items-center">
            <div class="bg-white p-2 rounded-lg mr-5 shadow-md">
                <img src="https://upload.wikimedia.org/wikipedia/commons/e/e0/Coat_of_arms_of_Semarang.svg" alt="Logo Semarang" class="h-16">
            </div>
            <div>
                <h1 class="text-2xl md:text-3xl font-extrabold leading-tight tracking-tight">BADAN KESATUAN BANGSA DAN POLITIK</h1>
                <p class="text-blue-200 text-sm md:text-base uppercase tracking-widest font-semibold">Agenda Kerja Pencapaian Indeks Kinerja 2026</p>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-6 py-10">
        
        <div class="bg-gray-100 shadow-inner rounded-t-xl overflow-hidden mb-0 no-print flex border-x border-t border-gray-200" id="month-tabs">
            </div>

        <main class="bg-white shadow-2xl rounded-b-xl border border-gray-200 overflow-hidden min-h-[600px]">
            <div id="welcome-msg" class="p-24 text-center">
                <div class="text-6xl mb-6 opacity-10 font-black tracking-tighter">BAKESBANGPOL</div>
                <h2 class="text-xl font-bold text-gray-600 uppercase tracking-[0.2em]">Monitoring Agenda Kerja</h2>
                <p class="text-gray-400 mt-3 text-sm">Sedang memuat data dari Google Sheets...</p>
            </div>

            <div id="content-display" class="hidden">
                <div class="bg-white px-8 py-8 border-b border-gray-100 flex justify-between items-end">
                    <div>
                        <h2 id="active-month-title" class="text-4xl font-black text-gray-900 uppercase italic tracking-tighter"></h2>
                        <p class="text-gray-400 text-sm font-medium mt-1">Daftar agenda kegiatan berdasarkan klasifikasi indikator kinerja utama.</p>
                    </div>
                    <button onclick="window.print()" class="no-print bg-blue-600 text-white px-6 py-2.5 rounded-lg text-xs font-bold hover:bg-blue-700 shadow-lg shadow-blue-200 transition-all flex items-center">
                        <span class="mr-2">üñ®Ô∏è</span> CETAK LAPORAN
                    </button>
                </div>

                <div class="p-8 space-y-12" id="table-container">
                    </div>
            </div>
        </main>
    </div>

    <footer class="bg-gray-100 border-t border-gray-200 py-10 mt-12 text-center text-gray-500 text-xs no-print">
        <p>&copy; 2026 Bakesbangpol Kota Semarang. Portal Internal Dashboard.</p>
    </footer>

    <script>
        // Link CSV dari Google Sheets Anda
        const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRbbOrCBNjyPcOQ4QIPZ04j2tghYDUecwpNmyQyrAZmBNRJ-O18vfWKcvDd2yCn-Q/pub?output=csv";
        
        let database = [];

        const colorMap = {
            "Indeks Demokrasi": { border: "#2563eb", bg: "#eff6ff", text: "#1e40af" },
            "Indeks Aktualisasi Pancasila": { border: "#dc2626", bg: "#fef2f2", text: "#991b1b" },
            "Indeks Kewaspadaan Nasional": { border: "#16a34a", bg: "#f0fdf4", text: "#166534" },
            "Indeks Harmoni Indonesia": { border: "#9333ea", bg: "#faf5ff", text: "#6b21a8" },
            "Indeks Kinerja Ormas": { border: "#ea580c", bg: "#fff7ed", text: "#9a3412" }
        };

        const months = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];

        // Inisialisasi Website
        window.onload = function() {
            document.getElementById('current-date').innerText = new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            
            // Render Tab Bulan
            const tabContainer = document.getElementById('month-tabs');
            months.forEach(m => {
                const btn = document.createElement('button');
                btn.className = "month-tab flex-1 py-4 text-[11px] font-bold uppercase hover:bg-white transition-all text-gray-500 border-r border-gray-200 last:border-0";
                btn.innerText = m.substring(0, 3);
                btn.onclick = (e) => filterByMonth(m, e.target);
                tabContainer.appendChild(btn);
            });

            // Ambil Data dari Google Sheets
            Papa.parse(SHEET_URL, {
                download: true,
                header: true,
                complete: function(results) {
                    database = results.data;
                    document.querySelector('#welcome-msg p').innerText = "Data berhasil dimuat. Pilih periode bulan di atas.";
                }
            });
        };

        function filterByMonth(monthName, element) {
            document.querySelectorAll('.month-tab').forEach(t => t.classList.remove('nav-active'));
            element.classList.add('nav-active');
            
            document.getElementById('welcome-msg').classList.add('hidden');
            document.getElementById('content-display').classList.remove('hidden');
            document.getElementById('active-month-title').innerText = monthName;

            const container = document.getElementById('table-container');
            container.innerHTML = '';

            // Filter & Sort
            const filtered = database.filter(d => d["Bulan"] === monthName)
                                     .sort((a,b) => a["Tanggal (DD/MM/YYYY)"].localeCompare(b["Tanggal (DD/MM/YYYY)"]));

            if (filtered.length === 0) {
                container.innerHTML = `<div class="text-center py-24 bg-gray-50 rounded-3xl border-2 border-dashed border-gray-200 text-gray-300 italic font-serif text-lg">Belum Ada Agenda Terdaftar di Sheets</div>`;
                return;
            }

            // Grouping by Indeks Kinerja
            const grouped = filtered.reduce((acc, obj) => {
                const key = obj["Indeks Kinerja"];
                if (!acc[key]) acc[key] = [];
                acc[key].push(obj);
                return acc;
            }, {});

            for (const [title, items] of Object.entries(grouped)) {
                const colors = colorMap[title] || { border: "#64748b", bg: "#f8fafc", text: "#1e293b" };
                const section = document.createElement('div');
                section.innerHTML = `
                    <div class="flex items-center mb-5">
                        <div class="h-10 w-2.5 mr-4 rounded-full" style="background-color: ${colors.border}"></div>
                        <h3 class="text-xl font-extrabold uppercase tracking-tight" style="color: ${colors.text}">${title}</h3>
                    </div>
                    <div class="overflow-hidden rounded-2xl border border-gray-200 shadow-sm">
                        <table class="w-full text-left border-collapse table-fixed">
                            <thead>
                                <tr style="background-color: ${colors.bg}">
                                    <th class="col-tanggal p-4 border-b border-gray-200 text-[10px] font-black uppercase tracking-widest" style="color: ${colors.text}">Tanggal</th>
                                    <th class="col-kegiatan p-4 border-b border-gray-200 text-[10px] font-black uppercase tracking-widest" style="color: ${colors.text}">Deskripsi Kegiatan</th>
                                    <th class="col-status p-4 border-b border-gray-200 text-[10px] font-black uppercase tracking-widest" style="color: ${colors.text}">Status</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm text-gray-700 bg-white">
                                ${items.map(i => `
                                    <tr class="table-row border-b border-gray-100 last:border-0 hover:bg-gray-50 transition-colors">
                                        <td class="col-tanggal p-4 font-bold border-r border-gray-50 text-blue-900">${i["Tanggal (DD/MM/YYYY)"]}</td>
                                        <td class="col-kegiatan p-4 font-medium leading-relaxed">${i["Kegiatan"]}</td>
                                        <td class="col-status p-4">
                                            <span class="px-3 py-1 rounded-full text-[10px] font-bold ${i["Status"] === 'SELESAI' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-400'}">
                                                ${i["Status"] || 'TERJADWAL'}
                                            </span>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                container.appendChild(section);
            }
        }
    </script>
</body>
</html>